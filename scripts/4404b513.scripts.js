"use strict";angular.module("morningPlannerApp",["ngCookies","ngResource","ngSanitize","ui.bootstrap"]),angular.module("morningPlannerApp").controller("MainCtrl",["$scope","$timeout","$window",function(a,b,c){function d(){c.localStorage.tasks=angular.toJson(a.tasks)}function e(){var c=a.now();a.currentTask=a.tasks.reduce(function(a,b){return f(b.time)>f(c)?a:b},{time:void 0});var d=a.tasks.indexOf(a.currentTask)+1,i=d<a.tasks.length?a.tasks[d]:void 0;if(i){var j=g(a.currentTask.time),k=g(i.time);a.currentProgress=(c-j)/(k-j)*100}else a.currentProgress=100;h=b(e,1e3)}function f(a){return moment(a).format("HH:mm")}function g(a){return moment(f(a),"HH:mm").toDate()}var h;a.tasks=angular.fromJson(c.localStorage.tasks)||[],a.tasks.forEach(function(a){a.time=new Date(a.time)}),a.now=function(){return new Date},a.task={},a.createNewTask=function(b){a.tasks.push({time:moment(a.task.hours+":"+a.task.minutes,"HH:mm").toDate(),title:a.task.title}),a.tasks=a.tasks.sort(function(a,b){return f(a.time)>f(b.time)?1:-1}),a.task={},b.$setPristine(),d()},a.deleteTask=function(b){a.tasks.splice(a.tasks.indexOf(b),1),d()},a.dateFilter=function(a){return f(a.time)>f(new Date)},e(),a.$on("$destroy",function(){h&&b.cancel(h)})}]),function(){angular.module("morningPlannerApp").directive("clock",["$timeout",function(a){return{scope:!0,restrict:"EA",template:'<div class="clock"><h2>{{now | date: format}}</h2></div>',link:function(b,c,d){function e(){b.now=new Date,f=a(e,1e3)}var f;b.format=d.format||"HH:mm",e(),b.$on("$destroy",function(){f&&a.cancel(f)})}}}])}(),function(){angular.module("morningPlannerApp").directive("moveToNext",function(){return{restrict:"EA",require:"ngModel",link:function(a,b,c,d){a.$watch(function(){return d.$valid},function(a){a&&d.$dirty&&$(":input:eq("+($(":input").index(b)+1)+")").focus()})}}})}(),function(){angular.module("morningPlannerApp").directive("focusOnSubmit",function(){return{restrict:"EA",require:"^form",link:function(a,b){b.closest("form").on("submit",function(){b.focus()})}}})}();